<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Capri - Resor - Cecilia Jakobsson</title>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S7XXTKR460"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('consent', 'default', {
      'analytics_storage': 'denied'
    });
    gtag('js', new Date());
    gtag('config', 'G-S7XXTKR460', { 'cookie_domain': 'none' });
  </script>
  <link rel="stylesheet" href="./css/style.css">
  <meta name="description" content="Följ med Cecilia Jakobsson på en oförglömlig resa till Capri. Utforska Blå Grottan, Villa San Michele och njut av italiensk kultur, mat och sång."> 
  <meta name="keywords" content="Capri, resa Capri, Cecilia Jakobsson, sjungande reseledaren, Italien, Amalfikusten, Blå Grottan, Villa San Michele, kulturresa">
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">Cecilia Jakobsson <span>Den personliga resan</span></div>
        <nav>
          <ul>
            <li><a href="index.html">Hem</a></li>
            <li><a href="resor.html">Resor</a></li>
            <li><a href="presentation.html">Presentation</a></li>
            <li><a href="foredrag.html">Föredrag</a></li>
            <li><a href="bildgalleri.html">Bildgalleri</a></li>
            <li><a href="kontakt.html">Kontakt</a></li>
          </ul>
        </nav>
        <a href="https://www.facebook.com/ceciliajakobsson.se" target="_blank" class="book-btn">
          <i>f</i> Boka nu via Facebook
        </a>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="page-title">
      <h2>Capri</h2>
    </div>

    <div class="tour-detail-container" id="tour-detail-container">
      <!-- Tour content will be loaded dynamically -->
    </div>

    <div class="tour-image-gallery">
      <h3>Resebilder</h3>
      <section class="gallery-section">
        <div class="gallery-grid">
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/tour-capri.jpg', 'Capri - Överblick av ön')" style="background-image: url('./assets/images/tours/tour-capri.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri1.jpg', 'Capri - Utsikt över havet')" style="background-image: url('./assets/images/tours/capri/Capri1.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri2.jpg', 'Capri - Klippformationer')" style="background-image: url('./assets/images/tours/capri/Capri2.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri3.jpg', 'Capri - Marina Grande')" style="background-image: url('./assets/images/tours/capri/Capri3.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri4.jpg', 'Capri - Gator och byggnader')" style="background-image: url('./assets/images/tours/capri/Capri4.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri5.jpg', 'Capri - Naturskåna vyer')" style="background-image: url('./assets/images/tours/capri/Capri5.jpg');"></div>
        </div>
        <div class="show-more-container">
          <button class="show-more-btn" onclick="toggleGalleryImages('capri-tour-extra')" id="capri-tour-toggle">Visa fler bilder från Capri</button>
        </div>
        <div class="gallery-grid gallery-extra" id="capri-tour-extra" style="display: none;">
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri6.jpg', 'Capri - Arkitektur och natur')" style="background-image: url('./assets/images/tours/capri/Capri6.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri7.jpg', 'Capri - Panoramavy')" style="background-image: url('./assets/images/tours/capri/Capri7.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri8.jpg', 'Capri - Strandvy')" style="background-image: url('./assets/images/tours/capri/Capri8.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri9.jpg', 'Capri - Blå himmel och hav')" style="background-image: url('./assets/images/tours/capri/Capri9.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri10.jpg', 'Capri - Dramatiska klippor')" style="background-image: url('./assets/images/tours/capri/Capri10.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/capri_new1.jpg', 'Capri - Ny bild 1')" style="background-image: url('./assets/images/tours/capri/capri_new1.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/capri_new2.jpg', 'Capri - Ny bild 2')" style="background-image: url('./assets/images/tours/capri/capri_new2.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/capri_new3.jpg', 'Capri - Ny bild 3')" style="background-image: url('./assets/images/tours/capri/capri_new3.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/capri_new4.jpg', 'Capri - Ny bild 4')" style="background-image: url('./assets/images/tours/capri/capri_new4.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri11.jpg', 'Capri - Solnedgång')" style="background-image: url('./assets/images/tours/capri/Capri11.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri12.jpg', 'Capri - Kristallklart vatten')" style="background-image: url('./assets/images/tours/capri/Capri12.jpg');"></div>
          <div class="gallery-item" onclick="openLightbox('./assets/images/tours/capri/Capri13.jpg', 'Capri - Traditionell arkitektur')" style="background-image: url('./assets/images/tours/capri/Capri13.jpg');"></div>
        </div>
      </section>
      
      <!-- Lightbox Modal -->
      <div id="lightbox" class="lightbox" onclick="closeLightbox()">
        <span class="lightbox-close">&times;</span>
        <img id="lightbox-img" class="lightbox-content" alt="" onclick="event.stopPropagation()">
        <div id="lightbox-caption" class="lightbox-caption" onclick="event.stopPropagation()"></div>
        <button class="lightbox-prev" onclick="event.stopPropagation(); changeLightboxImage(-1)">❮</button>
        <button class="lightbox-next" onclick="event.stopPropagation(); changeLightboxImage(1)">❯</button>
      </div>
    </div>
  </main>

  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>Cecilia Jakobsson</h3>
          <p>Den sjungande reseledaren som tar dig med på oförglömliga resor.</p>
          <div class="social-links">
            <a href="https://www.facebook.com/ceciliajakobsson.se" target="_blank"><i>f</i></a>
            <a href="https://instagram.com" target="_blank"><i>i</i></a>
          </div>
        </div>
        <div class="footer-section">
          <h3>Snabblänkar</h3>
          <ul>
            <li><a href="index.html">Hem</a></li>
            <li><a href="resor.html">Resor</a></li>
            <li><a href="presentation.html">Presentation</a></li>
            <li><a href="foredrag.html">Föredrag</a></li>
            <li><a href="bildgalleri.html">Bildgalleri</a></li>
            <li><a href="kontakt.html">Kontakt</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Boka Din Resa</h3>
          <p>Boka din plats på någon av mina kommande resor!</p>
          <a href="https://m.me/ceciliajakobsson.se" target="_blank" class="book-btn">
            <i>f</i> Boka nu via Facebook
          </a>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 Cecilia Jakobsson. Alla rättigheter förbehållna.</p>
      </div>
    </div>
  </footer>

  <div id="cookie-consent" class="cookie-consent" style="display: none;">
    <div class="cookie-content">
      <h3>Vi använder cookies</h3>
      <p>Vi använder cookies för att förbättra din upplevelse, analysera trafik och personanpassa innehåll. Genom att klicka på "Acceptera alla" godkänner du vår användning av cookies. Du kan också välja att anpassa dina inställningar.</p>
      <div class="cookie-buttons">
        <button id="accept-all-cookies" class="cookie-btn accept-btn">Acceptera alla</button>
        <button id="customize-cookies" class="cookie-btn customize-btn">Anpassa inställningar</button>
        <button id="reject-cookies" class="cookie-btn reject-btn">Avvisa alla</button>
      </div>
    </div>
  
    <div id="cookie-settings" class="cookie-settings" style="display: none;">
      <h3>Cookie-inställningar</h3>
      <div class="cookie-option">
        <div>
          <input type="checkbox" id="necessary-cookies" checked disabled>
          <label for="necessary-cookies">Nödvändiga cookies</label>
        </div>
        <p>Dessa cookies är nödvändiga för att webbplatsen ska fungera och kan inte stängas av.</p>
      </div>
      <div class="cookie-option">
        <div>
          <input type="checkbox" id="analytics-cookies">
          <label for="analytics-cookies">Analys-cookies</label>
        </div>
        <p>Hjälper oss att förstå hur besökare använder webbplatsen, vilket gör att vi kan förbättra hur den fungerar.</p>
      </div>
      <div class="cookie-option">
        <div>
          <input type="checkbox" id="marketing-cookies">
          <label for="marketing-cookies">Marknadsförings-cookies</label>
        </div>
        <p>Används för att spåra besökare på webbplatser. Avsikten är att visa annonser som är relevanta och engagerande.</p>
      </div>
      <div class="cookie-buttons settings-buttons">
        <button id="save-preferences" class="cookie-btn save-btn">Spara inställningar</button>
        <button id="cancel-preferences" class="cookie-btn cancel-btn">Avbryt</button>
      </div>
    </div>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', function() {
    const consentDiv = document.getElementById('cookie-consent');
    const settingsDiv = document.getElementById('cookie-settings');
  
    const acceptAllBtn = document.getElementById('accept-all-cookies');
    const rejectBtn = document.getElementById('reject-cookies');
    const customizeBtn = document.getElementById('customize-cookies');
    const saveBtn = document.getElementById('save-preferences');
    const cancelBtn = document.getElementById('cancel-preferences');
    
    if (!localStorage.getItem('cookieConsent')) {
      if (consentDiv) consentDiv.style.display = 'block';
    } else {
      applyConsent();
    }
  
    const acceptAllCookiesHandler = () => {
      localStorage.setItem('cookieConsent', 'accepted');
      localStorage.setItem('analyticsCookies', 'true');
      localStorage.setItem('marketingCookies', 'true');
      if (consentDiv) consentDiv.style.display = 'none';
      if (settingsDiv) settingsDiv.style.display = 'none'; // Ensure settings panel is also hidden
      document.querySelector('.cookie-content').style.display = 'block'; // Ensure main consent content is visible if customize was clicked then accept all
      applyConsent();
    };
  
    const rejectCookies = () => {
      localStorage.setItem('cookieConsent', 'rejected');
      localStorage.setItem('analyticsCookies', 'false');
      localStorage.setItem('marketingCookies', 'false');
      if (consentDiv) consentDiv.style.display = 'none';
      if (settingsDiv) settingsDiv.style.display = 'none';
      document.querySelector('.cookie-content').style.display = 'block';
      applyConsent();
    };
  
    const customizeCookies = () => {
      if (settingsDiv) settingsDiv.style.display = 'block';
      document.querySelector('.cookie-content').style.display = 'none';
      // Populate checkboxes based on current consent
      const analyticsAllowed = localStorage.getItem('analyticsCookies') === 'true';
      const marketingAllowed = localStorage.getItem('marketingCookies') === 'true';
      const analyticsCheckbox = document.getElementById('analytics-cookies');
      const marketingCheckbox = document.getElementById('marketing-cookies');
      if (analyticsCheckbox) analyticsCheckbox.checked = analyticsAllowed;
      if (marketingCheckbox) marketingCheckbox.checked = marketingAllowed;
    };
  
    const savePreferences = () => {
      const analyticsCheckbox = document.getElementById('analytics-cookies');
      const marketingCheckbox = document.getElementById('marketing-cookies');
      const analyticsConsent = analyticsCheckbox ? analyticsCheckbox.checked : false;
      const marketingConsent = marketingCheckbox ? marketingCheckbox.checked : false;
      
      localStorage.setItem('cookieConsent', 'custom');
      localStorage.setItem('analyticsCookies', analyticsConsent);
      localStorage.setItem('marketingCookies', marketingConsent);
      
      if (consentDiv) consentDiv.style.display = 'none';
      if (settingsDiv) settingsDiv.style.display = 'none';
      document.querySelector('.cookie-content').style.display = 'block';
      applyConsent();
    };
  
    const cancelPreferences = () => {
      if (settingsDiv) settingsDiv.style.display = 'none';
      document.querySelector('.cookie-content').style.display = 'block';
      // If no consent was previously given, keep the main banner up.
      // If consent was given, the banner would be hidden anyway.
      if (!localStorage.getItem('cookieConsent')) {
         if (consentDiv) consentDiv.style.display = 'block';
      }
    };
  
    if (acceptAllBtn) acceptAllBtn.addEventListener('click', acceptAllCookiesHandler);
    if (rejectBtn) rejectBtn.addEventListener('click', rejectCookies);
    if (customizeBtn) customizeBtn.addEventListener('click', customizeCookies);
    if (saveBtn) saveBtn.addEventListener('click', savePreferences);
    if (cancelBtn) cancelBtn.addEventListener('click', cancelPreferences);
  
    function applyConsent() {
      const analyticsConsent = localStorage.getItem('analyticsCookies') === 'true' ? 'granted' : 'denied';
      
      if (typeof gtag === 'function') {
        gtag('consent', 'update', {
          'analytics_storage': analyticsConsent
          // If you add marketing cookies that gtag handles, add 'marketing_storage' here
        });
      }
    }
    
    // Immediately apply consent if already set (moved to top of script)
    // applyConsent(); // Called within the initial check now
  });
  </script>

  <script>
    // Load tour data dynamically
    fetch('tours.json')
      .then(response => response.json())
      .then(data => {
        const capriTour = data.tours.find(tour => tour.id === 1); // Capri tour has id 1
        if (capriTour) {
          const container = document.getElementById('tour-detail-container');
          container.innerHTML = `
            <img src="${capriTour.image}" alt="${capriTour.title}" class="tour-detail-image">
            <div class="tour-detail-content">
              <h3 class="tour-detail-subtitle">Den lilla men storslagna ön</h3>
              <p>${capriTour.long_description}</p>

              <div class="tour-meta-detail">
                <p><strong>Varaktighet:</strong> ${capriTour.days}</p>
                <p><strong>Pris:</strong> ${capriTour.price}</p>
                <p><strong>Platser:</strong> ${capriTour.places}</p>
                ${capriTour.urgency_text ? `<p class="urgency-text-detail"><strong>${capriTour.urgency_text}</strong></p>` : ''}
              </div>

              <a href="https://m.me/ceciliajakobsson.se" target="_blank" class="book-btn tour-detail-book-btn">
                <i>f</i> Boka denna resa
              </a>
              
              <div class="booking-info">
                <p><strong>Vill du veta mer?</strong> Kontakta mig via Facebook för detaljerad information om resans innehåll, exakt pris och vad som ingår. Jag svarar gärna på alla dina frågor.</p>
              </div>
              
              <a href="resor.html" class="back-to-tours-btn">Tillbaka till alla resor</a>
            </div>
          `;
        }
      })
      .catch(error => console.error('Error loading tour data:', error));
  </script>

  <script>
    // Gallery functionality
    let currentImageIndex = 0;
    let currentImages = [];

    function openLightbox(imgSrc, caption) {
      const lightbox = document.getElementById('lightbox');
      const lightboxImg = document.getElementById('lightbox-img');
      const lightboxCaption = document.getElementById('lightbox-caption');
      
      lightboxImg.src = imgSrc;
      lightboxCaption.textContent = caption;
      lightbox.style.display = 'flex';
      
      // Build array of all images for navigation
      currentImages = getAllGalleryImages();
      currentImageIndex = currentImages.findIndex(img => img.src === imgSrc);
      
      document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }

    function closeLightbox() {
      const lightbox = document.getElementById('lightbox');
      lightbox.style.display = 'none';
      document.body.style.overflow = 'auto'; // Restore scrolling
    }

    function changeLightboxImage(direction) {
      currentImageIndex += direction;
      
      if (currentImageIndex >= currentImages.length) {
        currentImageIndex = 0;
      } else if (currentImageIndex < 0) {
        currentImageIndex = currentImages.length - 1;
      }
      
      const lightboxImg = document.getElementById('lightbox-img');
      const lightboxCaption = document.getElementById('lightbox-caption');
      
      lightboxImg.src = currentImages[currentImageIndex].src;
      lightboxCaption.textContent = currentImages[currentImageIndex].caption;
    }

    function getAllGalleryImages() {
      const images = [];
      document.querySelectorAll('.gallery-item').forEach(item => {
        const backgroundImage = item.style.backgroundImage;
        const src = backgroundImage.slice(5, -2); // Remove 'url("' and '")'
        const caption = item.getAttribute('onclick').match(/'([^']+)'/g)[1].slice(1, -1);
        images.push({ src, caption });
      });
      return images;
    }

    function toggleGalleryImages(sectionId) {
      const section = document.getElementById(sectionId);
      const button = document.getElementById(sectionId.replace('-extra', '-toggle'));
      
      if (section.style.display === 'none') {
        section.style.display = 'grid';
        button.textContent = button.textContent.replace('Visa fler', 'Visa färre');
      } else {
        section.style.display = 'none';
        button.textContent = button.textContent.replace('Visa färre', 'Visa fler');
      }
    }

    // Close lightbox with Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeLightbox();
      } else if (e.key === 'ArrowLeft') {
        changeLightboxImage(-1);
      } else if (e.key === 'ArrowRight') {
        changeLightboxImage(1);
      }
    });
  </script>

</body>
</html>